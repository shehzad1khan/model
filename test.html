<!doctype html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Demo</title>
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.22/css/jquery.dataTables.css">
    <link rel="stylesheet" type="text/css" href="https://datatables.net/media/css/site-examples.css">

    <!-- chosen select library -->
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.8.7/chosen.min.css">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.8.7/chosen.jquery.min.js"></script>


</head>

<body>

    <div style="margin: 20px;">

        <table id="example" class="display dataTable cell-border" style="width:100%">
            <thead>
                <tr>
                    <th>From Country</th>
                    <th>To Country</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                </tr>
            </tbody>
            <tfoot>
                <tr>
                    <th></th>
                    <th></th>
                </tr>
            </tfoot>
        </table>

    </div>

    <script>
        $(document).ready(function() {

            $('#example tfoot th').each(function(idx) {
                var title = $(this).text();
                $(this).html('<input id="in_' + idx + '" type="text" placeholder="Search ' + title + '"/>');
            });

            var table = $('#example').DataTable({

                dom: 'lrtip', // removed "f" for "filter".

                columnDefs: [{
                    targets: [0, 1],
                    render: function(data, type, row) {
                        var select = $('<select multiple class="chosen-select"><option value=""></option></select>');
                        select.append('<option value="Argentina">Argentina</option>');
                        select.append('<option value="Brazil">Brazil</option>');
                        select.append('<option value="Cuba">Cuba</option>');
                        select.append('<option value="Denmark">Denmark</option>');
                        select.append('<option value="Egypt">Egypt</option>');
                        return select[0].outerHTML;
                    }
                }],

                initComplete: function() {
                    var api = this.api();
                    api.columns().each(function() {
                        $('input', this.footer()).on('keyup change clear', function() {
                            api.draw();
                        });
                    });
                }
            });

            $.fn.dataTable.ext.search.push(
                function(settings, searchData, index, rowData, counter) {

                    var fromFilter = $('#in_0').val();
                    var toFilter = $('#in_1').val();

                    var trNode = table.row([index]).node();

                    var fromTdNode = $("td:nth-child(1)", trNode);
                    var fromSelectedValNodes = $("select option:selected", fromTdNode);
                    var fromSelections = '';
                    fromSelectedValNodes.each(function() {
                        fromSelections += ($(this).val() + ', ');
                    });

                    var toTdNode = $("td:nth-child(2)", trNode);
                    var toSelectedValNodes = $("select option:selected", toTdNode);
                    var toSelections = '';
                    toSelectedValNodes.each(function() {
                        toSelections += ($(this).val() + ', ');
                    });

                    if (fromSelections.trim().toLowerCase().includes(fromFilter.trim().toLowerCase()) &&
                        toSelections.trim().toLowerCase().includes(toFilter.trim().toLowerCase())) {
                        return true;
                    } else {
                        return false;
                    }
                }
            );

            $(".chosen-select").chosen({
                width: "75%"
            });


        });
    </script>

</body>

</html>